{"title":"Exercise 3: Simple Sampling Designs","markdown":{"headingText":"Exercise 3: Simple Sampling Designs","headingAttr":{"id":"terrain-spatial-interpolation","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"```{r}\n#| echo: false \n```\n\n\nWritten by\n\n```{r results='asis'}\n#| echo: false\n```\n\n```{r}\n#| echo: false\n#| warning: false \nset.seed(1234)\nlibrary(pacman)\np_load(tidyverse, ggplot2, dplyr)\n## set up some useful functions \n## variance around the maean \nvar_simple_random <- function(data){\n  ybar <- mean(data, na.rm =T) ## calculate the mean\n  top_sum <- sum((data - ybar) ^ 2)\n  df <- length(data)\n  var_simple <- top_sum/ (df-1)\n  return(var_simple)\n}\n## fix this code\nsd_simple_random <- function(data, replacement = T, N_big = NULL) {\n  ybar <- mean(data, na.rm = T) ## calculate the mean\n  top_sum <- sum((data - ybar) ^ 2)\n  df <- length(data)\n  var_simple <- top_sum / (df - 1)\n  if (replacement == F) {\n    ## adjustment neded to control for the limited sampel\n    if (length(N_big) == 0) {\n      return('Total Possible Needed')\n    } else if (length(N_big) > 0) {\n      adj_fct <- (N_big - df) / N_big\n      sd_mean = (var_simple / df) * adj_fct\n      return(sd_mean)\n    }\n  }\n  else {\n    sd_mean = var_simple / df\n    return(sd_mean)\n  }\n}\n## confidence intervals for meean of population\nconfident_interval <- function(x, alpha = 0.05){\n  n <- length(x)\n  mean_x <- mean(x)\n  ## this is the sd of the mean \n  se <- sd(x)/sqrt(n)\n  t_value <- qt(1 - alpha/2, df = n - 1)\n  ## confidence ofthe mean of the population\n  ci <- mean_x + c(-1, 1) * t_value * se\n  return(ci)\n}\nnew_sample_size <- function(Allowable_Error, \n                            data,\n                            replacement = TRUE,\n                            N = 100) {\n  ## calculate confidence interval \n  CI <- confident_interval(data)\n  \n  ## percent error \n  PE <- (diff(CI) * 0.5) / mean(data) * 100\n  \n  ## calculate mean\n  mean_val <- mean(data)\n\n  #test_stat <- mean_val - 0.95 / (var(data)^0.5)\n  t_val <- qt(0.95, df = length(data)-1, lower.tail = T)\n  t_val\n  sd_ <- sd(data)\n  CV = (sd_ / mean_val) * 100 \n  if (replacement == FALSE) {\n    Q <- Allowable_Error^2 / (t_val^2 * CV^2)\n    n_out <- 1 / ((1 / N) + Q)\n    n_out\n    } else {\n    n_out <- (t_val^2 * CV^2)/ Allowable_Error^2\n  }\n  return(round(n_out))\n}\n```\n\n## Lab Overview {.unnumbered}\n\nThis lab uses a \"simulated\" forest to practice simple random sampling, summarizing the data, and then using that information as we would in a real forest environment. We will use this sample data to estimate important forest metrics and confidence around our estimates.\n\n------------------------------------------------------------------------\n\n## Learning Objectives {.unnumbered}\n\n-   Estimate the population mean and the confidence intervals using simple random sampling\n\n-   Apply estimates + confidence intervals to answer management questions\n\n-   Apply a systematic sampling design to estimate population mean and confidence intervals\n\n-   Compare the cost and relative efficacy of different sampling regimes.\n\n::: callout-note\nPrior to completing this exercise go over the terminology and equations included the course lecture material. It is important to know what a *population* mean is and how we describe this using *estimators*\n:::\n\n## Data Overview {.unnumbered}\n\n**Simulated Forest Landscape**\n\n```{r}\n#| echo: false\n##| fig.height: 9  \n# Create a data frame with the grid coordinates and labels\ngrid_data <- expand.grid(x =1:8, y = 1:14)\n\n# Assign labels in a zigzag pattern\ngrid_data <- grid_data %>%\n  arrange(x, -y) \ngrid_data$plot_label <- seq(1, 112, by = 1)\ngrid_data$plot_vol <- round(rnorm(112, 9.5, 2))\n\n# ggplot(grid_data, aes(x = x, y = y)) +\n#   geom_tile(color = \"black\", fill = \"white\") +  # Draw the grid\n#   geom_text(aes(label = plot_label), \n#             size = 4, hjust = 0, vjust = 1, \n#             nudge_x = -0.4, nudge_y = 0.4) +  # Add labels\n#   geom_text(aes(label = plot_vol), \n#                 size = 2.5,hjust = 0, vjust = 1, \n#             nudge_x = 0.2, nudge_y = -0.1, color  ='grey35') +\n#   scale_x_continuous(breaks = 1:14, minor_breaks = NULL) +\n#   scale_y_continuous(breaks = 1:8, minor_breaks = NULL) +\n#   theme_minimal() +\n#   theme(  theme(\n#     panel.grid = element_blank()), \n#     axis.text  = element_blank()) + # Remove grid lines)) + \n#     coord_fixed(1)\n```\n\n------------------------------------------------------------------------\n\n![Each square is a 14.14 m X 14.14 m plot (0.02 ha plot). Numbers on the top left-hand corners are plot numbers, whereas numbers on the bottom right-hand corner are volumes (m3/0.02 ha). North is at the top of the map](images/clipboard-333927722.png)\n\n## Task 1: Simple Random Sampling {.unnumbered}\n\n**Step 1**\n\n### Question 1 {.unnumbered}\n\nUsing the map above select n=15 plots using simple random sampling without replacement. Explain how you used **simple random sampling replacement to select the data**. How did you choose random numbers?\n\n```{r}\n#| code-fold: true\n#| code-summary: \"Show the code\"\n## develop a sample \nplot_sample <- sample(x = 1:112, size = 15, replace = F)\n```\n\n### Question 2 {.unnumbered}\n\nCalculate:\n\n1.  Mean volume per plot\n2.  The estimated plot-to-plot variance\n3.  The estimated variance of the mean (remember that this is sampling without replacement)\n4.  The estimated standard error of the mean\n5.  95% confidence interval for this mean.\n\n::: callout-note\n*You must should calculations and include measurement units in your responses. For your confidence interval calculation, shot is a range with the lower value first.*\n:::\n\n```{r}\n#| echo: false\nlibrary(dplyr)  # Ensure dplyr is loaded for filter function\n\n## develop a sample \nplot_sample <- filter(grid_data, plot_label %in% sample(x = 1:112, size = 15, replace = FALSE))\nmean_n <- mean(plot_sample$plot_vol, na.rm = TRUE)\n#var <- var(plot_sample$plot_vol)\nvariance <- var_simple_random(plot_sample$plot_vol)\n\n## standard error of the mean \nsd <- sd_simple_random(plot_sample$plot_vol, replacement = FALSE, N_big = 112)\nconfident_intervals <- confident_interval(plot_sample$plot_vol)\n```\n\n### Question 3 {.unnumbered}\n\nConvert the estimated mean volume per plot and the associated confidence interval to an equivalent per hectare estimate (e.g. 200m3/ha with a confidence interval of (100 m3/ha)\n\n```{r}\n#| echo: false\n# convert using known area relationship \nplot_areas <- 0.02 #ha\nmean_ha <- mean_n / plot_areas ## here our conversion factor is (1 ha / 0.2 ha)\nconfident_intervals_ha <- confident_intervals / plot_areas\n```\n\n### Question 4 {.unnumbered}\n\nBased on the volume per ha values, where in BC might these data have come from? Consider (1) ecosystem type (2) time since disturbances. To provide context, a very productive old stand in the Boreal Forest of Canada could have up to 500 m^3^/ha (most are much less). A very productive old stand in the Temperate Rainforest of the western coast of Canada could have 1,500 m^3^/ha. Also, 1 m^3^ is about the size of a utility pole (e.g., telephone or electricity pole).\n\n### Question 5 {.unnumbered}\n\nHow large is total plot area in hectares (you determined this in Activity 3 already)? Use this to expand the mean in m^3^/ha and the associated confidence interval to obtain the estimated total m^3^ volume for the land area and a 95% confidence interval for this estimate. Based on this confidence interval, would you say that there could be 1200 m^3^ of volume in this area?\n\n```{r}\n#| echo: false \nplot_areas <- 0.02 #ha\nnplots <- 112 \ntotal_area <- plot_areas * nplots\ntotal_mean <- mean_ha * total_area\ntotal_confident_intervals <- confident_intervals_ha * total_area\n```\n\n### Question 6 {.unnumbered}\n\nCalculate the Percent Error achieved for your survey. Did you achieve the desired percent error of  + or – 15% of the mean with 95% probability? NOTE: This is the standard for operational cruising in BC for scale-based sales (i.e., billing is based on scaled logs not on standing estimated cruise volumes).\n\n```{r}\n#| echo: false \npercent_error <- (diff(confident_intervals) * 0.5) / mean_n * 100\n```\n\n------------------------------------------------------------------------\n\n## Task 2: Systematic Random Sampling {.unnumbered}\n\nFor the following questions imagine a forester is planning a survey with the with the following specifications:\n\nA.  Intensity (*I*) = 0.02 (i.e., 2 %)\n\nB.  Forest land area (*A*) = 100 ha (1000 m X 1000 m; 1 ha = 10,000 m^2^)\n\nC.  Size of plot (*a*)= 0.02 ha (i.e., 14.14 X 14.14 square plot)\n\n### Question 7 {.unnumbered}\n\nA.  The area of the all of the plots of that will be needed for this forester’s survey using this intensity (A*p*); and\n\nB.  The number of samples (*n*) required for this desired sampling intensity, given the specified plot size.\n\n```{r}\n#| echo: false \n## claculate the intensity \nI <- 0.02\nA <- 100\na <- 0.02\nAp = A * I\nn <- Ap / a\n```\n\n### Question 8 {.unnumbered}\n\nGiven that the length between plot centres (*B*) is fixed at 40 m, what is the length between lines (*L*)? **NOTE:** In practice, we would round down to the nearest 5 m to lay this out in the field. For example, if the answer was 103 m, we would use 40 m by 100 m spacing (not 105 m and not 103 m spacing), since forest land areas are often irregular in shape and this would “pull in” the systematic sampling grid to hopefully get enough plots.\n\nWhat would the spacing be, if this square spacing between plot centres was used instead? Again, in practice, we would round this answer down to the nearest 5 m to lay this out in the field.\n\nWhich of these two options would you choose to use and why?\n\n```{r}\n#| echo: false \n## claculate the intensity \nA <- 100 * 10000 ## convert to m^2\nB <- 40\nn <- 100\nrect_spacing <- A/(n * B)\nsquare_spacing <- sqrt(A/n)\n```\n\n### Question 9 {.unnumbered}\n\nUsing the square spacing calculated in 2b and the plot size, select random co-ordinates for you first plot centre in the first “grid” of your systematic survey. Show all calculations you used to get the random co-ordinates and to make sure that the plot will fit within the first “grid square” of your systematic survey given these random co-ordinates and the plot dimensions.\n\n```{r}\n#| echo: false\n#| output: false \n## calculate the intensity \n# spacing is 100 x 100 so we need to make sure that the plot fits within the grid\nx <- runif(1, 0, 100-14.14)\ny <- runif(1, 0, 100-14.14)\n## check if the plot fits within the grid\n# if (x + 14.14 < 100 & y + 14.14 < 100) {\n#   print('Plot fits within the grid')\n# } else {\n#   print('Plot does not fit within the grid')\n# }\n```\n\n### Question 10 {.unnumbered}\n\nGiven a fixed project cost of \\$5,000 (i.e., truck rental and other equipment) and a per day cost of \\$1,000 for a 2-person crew with a production rate of eight plots per day:\n\nA.  How long would the survey take?\n\nB.  What would the cost of this survey be?\n\n```{r}\n#| echo: false \n#| output: false\n## calculate the intensity \ntotal_days  = n / 8\ntotal_cost = 5000 + (total_days * 1000)\n```\n\n### Question 11 {.unnumbered}\n\nif the budget was set at \\$10,000:\n\nA.  How many plots could you have measured using the cost estimates in #10?\n\nB.  What would the sampling intensity be for this fixed budget?\n\nC.  Would this sampling intensity be more or less than the sampling intensity used in the sample plan (i.e., planned for 2%)?\n\n```{r}\n#| echo: false\n#| output: false\n## calculate n plots when cost is 10000\nc <- 10000 ## set maximum\nc_day <- 1000 ## cost/day\nA <- 100 ## area \na <- 0.02 ## plot area \nn_plots <- ((c - 5000) /c_day) * 8 \n# resolve equations for I \n#(n_plots * a) / A\n```\n\n------------------------------------------------------------------------\n\n## Lab Questions & Deliverables {.unnumbered}\n\n-   [ ] Complete answers for all 11 following questions:\n    -   [ ] Questions should show all work including calculations\n    -   [ ] If you used code, make sure to include the code you used to answer the question.\n\n## Summary {.unnumbered}\n\nIn this lab, we practiced the calculations of important summary statistics from a random sampling design. We also learned and applied our investigation to look at sampling intensity in systematic random sampling.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"03-Simple Sampling Design.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.323","github":{"repo":"https://github.com/ubc-geomatics-community-of-practice/GEM510-GIS-for-Forestry-and-Conservation.git"},"clean":["book.bib","bookdown.bbl","packages.bib"],"split-by":"chapter","downloads":"docx"},"extensions":{"book":{"multiFile":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","output-file":"03-Simple Sampling Design.docx"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"github":{"repo":"https://github.com/ubc-geomatics-community-of-practice/GEM510-GIS-for-Forestry-and-Conservation.git"},"clean":["book.bib","bookdown.bbl","packages.bib"]},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","docx"]}